<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    
    <meta name="theme-color" content="#33363b">
    <meta name="msapplication-TileColor" content="#33363b">
    
    
    <meta name="google-site-verification" content="VmX1m6eF3rZhAf1iR5DhqrbiF_5se-s902W14pPryQk">
    
    
    <meta name="keywords" content="Code, Music, Life, Linux, Arch Linux, Gentoo, JavaScript, ARIA, Hikaru">
    
    
    <link rel="apple-touch-icon" sizes="180x180" href="/favicons/apple-touch-icon.png">
    
    
    <link rel="icon" type="image/png" sizes="192x192" href="/favicons/android-chrome-192x192.png">
    
    
    <link rel="icon" type="image/png" sizes="32x32" href="/favicons/favicon-32x32.png">
    
    
    <link rel="icon" type="image/png" sizes="16x16" href="/favicons/favicon-16x16.png">
    
    
    <link rel="mask-icon" href="/favicons/safari-pinned-tab.svg" color="#33363b">
    
    
    <link rel="manifest" href="/favicons/site.webmanifest">
    
    
    <meta name="msapplication-config" content="/favicons/browserconfig.xml">
    
    
    <link rel="shortcut icon" type="image/x-icon" href="/favicons/favicon.ico">
    
    
    <link rel="alternate" href="/atom.xml" title="喵's StackHarbor" type="application/atom+xml" />
    
    
    <link rel="stylesheet" type="text/css" href="/css/normalize.css">
    <link rel="stylesheet" type="text/css" href="/css/index.css">
    
    <link rel="stylesheet" type="text/css" href="/css/sidebar.css">
    
    
<link rel="stylesheet" type="text/css" href="/css/page.css">
<link rel="stylesheet" type="text/css" href="/css/post.css">

    <link rel="stylesheet" type="text/css" href="/css/custom.css">
    <link rel="stylesheet" type="text/css" href="/css/atom-one-dark.css">
    <link rel="stylesheet" type="text/css" href="/css/lightgallery.min.css">
    <script type="text/javascript" src="/js/jquery.min.js"></script>
    <script defer type="text/javascript" src="/js/util.js"></script>
    <script defer type="text/javascript" src="/js/clipboard.min.js"></script>
    <script defer type="text/javascript" src="/js/scrollspy.js"></script>
    <script defer type="text/javascript" src="/js/fontawesome-all.min.js"></script>
    <script defer type="text/javascript" src="/js/lightgallery.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-fullscreen.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-hash.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-pager.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-thumbnail.min.js"></script>
    <script defer type="text/javascript" src="/js/lg-zoom.min.js"></script>
    
    <script defer src="/js/busuanzi.pure.mini.js"></script>
    
    
    <script defer type="text/javascript" src="/js/search.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      var searchPath = "/search.json";
      if ("search.json".length === 0) {
        searchPath = "/search.json";
      }
      searchFunc(searchPath, "search-input", "search-result");
    });
    </script>
    
    
    <script defer type="text/javascript" src="/js/index.js"></script>
    <script type="text/javascript">
    $(document).ready(function () {
      $(".post pre code figure.highlight").each(function (i, e) {
        $(e).before("<button class=\"copy button\">复制</button>");
      });
      var cb = new ClipboardJS("button.copy", {
        "target": function (trigger) {
            // Get target element by DOM API.
            // nextElementSibling is figure,highlight, lastChild is pre.code.
            return trigger.nextElementSibling.lastChild;
        }
      });
      cb.on("success", function (e) {
        e.clearSelection();
        var trigger = e.trigger;
        // Change button text as a user tip.
        trigger.innerHTML = "已复制";
        $(trigger).addClass("copied");
        // Change button text back;
        setTimeout(function () {
          trigger.innerHTML = "复制";
          $(trigger).removeClass("copied");
        }, 1500);
      });
    });
    </script>
    
    <script defer type="text/javascript" src="/js/custom.js"></script>
    <title>在 VPS 上用 Nginx 和 HTTPS 部署 Hexo 生成的页面 | 喵's StackHarbor - Whisper to the World</title>
  </head>
  <body itemscope itemtype="http://schema.org/WebPage" lang="zh_CN" data-spy="scroll" data-target=".list-group">
    
<header id="header" class="header" style="background: #33363b;">
  <div class="container">
    <div class="header-container">
      <div class="header-title">
        <h1 class="title"><a href="/">喵's StackHarbor</a></h1>
        <h2 class="subtitle">Whisper to the World</h2>
      </div>
      
      <div class="logo">
        <img src="/images/logo.png" alt="logo">
      </div>
      
    </div>
    <nav id="nav" class="nav">
      <a id="nav-toggle" class="nav-toggle" aria-hidden="true"><i class="fas fa-bars" aria-label="切换导航栏"></i></a>
      <ul id="menu" role="menubar" aria-hidden="false">
        
        <li role="menuitem"><a href="/"><i class="fas fa-home"></i><span class="menu-text">首页</span></a></li>
        
        <li role="menuitem"><a href="/archives/"><i class="fas fa-archive"></i><span class="menu-text">归档</span></a></li>
        
        <li role="menuitem"><a href="/categories/"><i class="fas fa-th-list"></i><span class="menu-text">分类</span></a></li>
        
        <li role="menuitem"><a href="/tags/"><i class="fas fa-tags"></i><span class="menu-text">标签</span></a></li>
        
        <li role="menuitem"><a href="/Undefined-Shell-Works/"><i class="fas fa-terminal"></i><span class="menu-text">Undefined Shell Works!</span></a></li>
        
        <li role="menuitem"><a href="/blogroll/"><i class="fas fa-link"></i><span class="menu-text">友情链接</span></a></li>
        
        <li role="menuitem"><a href="/about/"><i class="fas fa-user-edit"></i><span class="menu-text">关于</span></a></li>
        
      </ul>
    </nav>
  </div>
</header>


    <main id="main" class="main">
      <div class="container">
        <div class="main-container">
          <div class="content">
            
<div id="post" class="page">
  <article class="article post card animate" itemscope itemtype="http://schema.org/Article">
    <div class="post-block">
      <link itemprop="mainEntityOfPage" href="https://sh.alynx.xyz/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/">
      <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
        <meta itemprop="name" content="Alynx Zhou">
        <meta itemprop="description" content="望むものなら残さず<br>輝ける自分らしさで">
        <meta itemprop="image" content="/images/Future_Gazer_small.png">
      </span>
      <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
        <meta itemprop="name" content="喵's StackHarbor">
      </span>
    </div>
    <header class="post-header">
      <h1 class="post-title" itemprop="name headline">在 VPS 上用 Nginx 和 HTTPS 部署 Hexo 生成的页面</h1>
      <div class="post-meta">
        
        <span class="post-date meta-block">
          <i class="far fa-calendar-plus"></i><span><time title="post-date" itemprop="dateCreated datePublished" datetime="2018-06-04T08:21:17.000Z">2018-06-04 周一 16:21:17 CST</time></span>
        </span>
        
        
        <span class="post-categories meta-block">
          
          <i class="far fa-folder-open"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/" itemprop="url" rel="index"><span itemprop="name">计算机</span></a></span><i class="fas fa-angle-right"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BD%91%E7%BB%9C/" itemprop="url" rel="index"><span itemprop="name">网络</span></a></span><i class="fas fa-angle-right"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%AB%99/" itemprop="url" rel="index"><span itemprop="name">网站</span></a></span><i class="fas fa-angle-right"></i><span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AE%A1%E7%AE%97%E6%9C%BA/%E7%BD%91%E7%BB%9C/%E7%BD%91%E7%AB%99/Hexo/" itemprop="url" rel="index"><span itemprop="name">Hexo</span></a></span>
        </span>
        
        
        
        
      </div>
    </header>
    <main class="post-main" itemprop="articleBody">
      <p>&#x6628;&#x5929;&#x542C;&#x8BF4;&#x5FAE;&#x8F6F;&#x8981;&#x6536;&#x8D2D; GitHub &#x4E86;&#xFF0C;&#x5BF9;&#x4E8E;&#x6211;&#x4E00;&#x4E2A;&#x4E13;&#x4E1A;&#x5FAE;&#x8F6F;&#x53D7;&#x5BB3;&#x8005;&#xFF0C;&#x867D;&#x7136;&#x5B83;&#x6D17;&#x767D;&#x4E86;&#xFF0C;&#x4F46;&#x8FD8;&#x662F;&#x6709;&#x7740;&#x672C;&#x80FD;&#x7684;&#x4E0D;&#x4FE1;&#x4EFB;&#x3002;&#x540C;&#x65F6;&#x8F6F;&#x7C89;&#x8BA4;&#x8F6F;&#x505A;&#x7236;&#x7684;&#x6837;&#x5B50;&#x6211;&#x662F;&#x65AD;&#x7136;&#x63A5;&#x53D7;&#x4E0D;&#x4E86;&#x7684;&#xFF08;&#x201C;&#x6211;&#x5FAE;&#x8F6F;&#x7238;&#x7238;&#x5929;&#x4E0B;&#x7B2C;&#x4E00;&#xFF01;&#x201D;&#x201C;&#x4F60;&#x600E;&#x4E48;&#x80FD;&#x4E0D;&#x559C;&#x6B22;&#x6211;&#x5FAE;&#x8F6F;&#x7238;&#x7238;&#x5462;&#xFF01;&#x201D;&#x201C;&#x6211;&#x5FAE;&#x8F6F;&#x7238;&#x7238;&#x4EC0;&#x4E48;&#x65F6;&#x5019;&#x5751;&#x8FC7;&#x4F60;&#xFF01;&#x201D;&#xFF09;&#xFF0C;&#x4F60;&#x81EA;&#x5DF1;&#x559C;&#x6B22;&#x5C31;&#x559C;&#x6B22;&#xFF0C;&#x6211;&#x8BA8;&#x538C;&#x662F;&#x6211;&#x7684;&#x4E8B;&#x60C5;&#xFF0C;&#x5E0C;&#x671B;&#x5404;&#x4F4D;&#x5634;&#x4E0B;&#x7559;&#x60C5;&#xFF0C;&#x4E0D;&#x8981;&#x7ED9;&#x6211;&#x55B7;&#x6210;&#x7B5B;&#x5B50;&#x3002;</p>
<a id="more"></a>

<p>&#x8981;&#x8BF4;&#x6211;&#x53D7;&#x5BB3;&#x7684;&#x7ECF;&#x5386;&#x80FD;&#x8BF4;&#x597D;&#x51E0;&#x7BC7;&#x535A;&#x5BA2;&#xFF0C;&#x6700;&#x5E38;&#x89C1;&#x7684;&#x6BD4;&#x5982;&#x8BF4;&#x6628;&#x5929;&#x7B54;&#x8FA9; PPT &#x8F6E;&#x5230;&#x6211;&#x65F6;&#x5019;&#x5C31;&#x5D29;&#x6E83;&#x4E86;&#xFF08;&#x6211;&#x53EF;&#x4EE5;&#x786E;&#x5B9A;&#x4E0D;&#x662F;&#x6211; PPT &#x7684;&#x95EE;&#x9898;&#xFF0C;&#x56E0;&#x4E3A;&#x5173;&#x6389;&#x6240;&#x6709;&#x7684; PowerPoint &#x518D;&#x6253;&#x5F00;&#x5C31;&#x6CA1;&#x95EE;&#x9898;&#x4E86;&#xFF09;&#xFF08;&#x201C;&#x518D;&#x78B0;&#x8FD9;&#x8FA3;&#x9E21;&#x73A9;&#x610F;&#x6211;&#x5C31;&#x662F;&#x72D7;&#xFF01;&#x201D;&#xFF09;&#x3002;&#x518D;&#x6BD4;&#x5982;&#x8BF4;&#x90A3;&#x4E2A;&#x51FA;&#x4E86;&#x540D;&#x4E0D;&#x9760;&#x8C31;&#x7684;&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#xFF0C;&#x4F60;&#x89C1;&#x8FC7;&#x66F4;&#x65B0;&#x66F4;&#x65B0;&#x5931;&#x8D25;&#x56DE;&#x6EDA;&#x56DE;&#x6EDA;&#x5931;&#x8D25;&#x7684;&#x561B;&#xFF1F;&#x5408;&#x7740;&#x6211;&#x4E00;&#x5C0F;&#x65F6;&#x53EA;&#x80FD;&#x5BF9;&#x7740;&#x7535;&#x8111;&#x53D1;&#x5446;&#x770B;&#x4F60;&#x81EA;&#x7206;&#xFF1F;&#xFF08;&#x5F53;&#x7136;&#x8F6F;&#x7C89;&#x80AF;&#x5B9A;&#x4E0D;&#x627F;&#x8BA4;&#xFF1A;&#x201C;&#x6211;&#x4EEC;&#x66F4;&#x65B0;&#x90FD;&#x6210;&#x529F;&#x4E86;&#xFF01;&#x201D;&#xFF0C;&#x8FD9;&#x73A9;&#x610F;&#x8FD8;&#x5FC3;&#x8BDA;&#x5219;&#x7075;&#xFF1F;&#x53CD;&#x6B63;&#x6211;&#x88AB;&#x5751;&#x4E86;&#xFF09;&#x3002;&#x5012;&#x4E0D;&#x662F;&#x8BF4;&#x5B83;&#x6536;&#x8D2D; GitHub &#x7F6A;&#x5927;&#x6076;&#x6781;&#x4E86;&#xFF0C;&#x53EA;&#x4E0D;&#x8FC7;&#x662F;&#x6211;&#x81EA;&#x5DF1;&#x89C9;&#x5F97;&#x4E0D;&#x8212;&#x670D;&#x5C31;&#x662F;&#x4E86;&#xFF0C;&#x81F3;&#x4E8E;&#x666E;&#x7F57;&#x5927;&#x4F17;&#x8BE5;&#x5E72;&#x4EC0;&#x4E48;&#x5E72;&#x4EC0;&#x4E48;&#xFF0C;&#x4E0D;&#x8981;&#x7BA1;&#x6211;&#x3002;</p>
<p>&#x7136;&#x540E;&#x6211;&#x5C31;&#x628A;&#x6211;&#x8FD8;&#x7B97;&#x6709;&#x4EF7;&#x503C;&#x7684;&#x4E1C;&#x897F;&#x2014;&#x2014;&#x6211;&#x7684;&#x7F51;&#x7AD9;&#xFF0C;&#x642C;&#x5230;&#x4E86; VPS &#x4E0A;&#x9762;&#xFF0C;&#x642C;&#x8FC1;&#x8FC7;&#x7A0B;&#x76F8;&#x5BF9;&#x7B80;&#x5355;&#xFF0C;&#x7528; git &#x505A;&#x8FD9;&#x4E2A;&#x540C;&#x6B65;&#x80AF;&#x5B9A;&#x662F;&#x4E0D;&#x73B0;&#x5B9E;&#x7684;&#xFF0C;&#x56E0;&#x4E3A;&#x4F60;&#x60F3;&#x50CF; GitHub &#x4E00;&#x6837;&#x53EF;&#x4EE5;&#x76F4;&#x63A5;&#x7528; <code>hexo-deployer-git</code> push &#x7684;&#x8BDD;&#xFF0C;&#x4F60;&#x9700;&#x8981;&#x5EFA;&#x7ACB;&#x7684;&#x662F;&#x88F8;&#x4ED3;&#x5E93;&#xFF0C;&#x4E5F;&#x5C31;&#x662F;&#x6B63;&#x5E38;&#x7684; <code>.git</code> &#x76EE;&#x5F55;&#x91CC;&#x9762;&#x7684;&#x4E1C;&#x897F;&#xFF0C;&#x5F88;&#x663E;&#x7136;&#x8FD9;&#x4E0D;&#x662F;&#x7F51;&#x7AD9;&#x5185;&#x5BB9;&#x3002;&#x770B;&#x4E86;&#x4E00;&#x5708;&#x5176;&#x4ED6;&#x7684;&#x540C;&#x6B65;&#x65B9;&#x5F0F;&#xFF0C;rsync &#x770B;&#x8D77;&#x6765;&#x662F;&#x6700;&#x5408;&#x9002;&#x7684;&#x4E00;&#x4E2A;&#x4E86;&#xFF0C;&#x7136;&#x540E;&#x5C31;&#x5C1D;&#x8BD5;&#x4E86;&#x4E00;&#x4E0B;&#x3002;</p>
<h1 id="&#x7528;Rsync&#x4E0A;&#x4F20;Hexo&#x751F;&#x6210;&#x7684;&#x7F51;&#x9875;"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E7%94%A8Rsync%E4%B8%8A%E4%BC%A0Hexo%E7%94%9F%E6%88%90%E7%9A%84%E7%BD%91%E9%A1%B5" title="&#x7528;Rsync&#x4E0A;&#x4F20;Hexo&#x751F;&#x6210;&#x7684;&#x7F51;&#x9875;"></a>&#x7528; Rsync &#x4E0A;&#x4F20; Hexo &#x751F;&#x6210;&#x7684;&#x7F51;&#x9875;</h1>
<p>&#x9996;&#x5148;&#x9700;&#x8981;&#x5B89;&#x88C5; <code>hexo-deployer-rsync</code>&#xFF0C;&#x53E6;&#x5916;&#x4E5F;&#x8981;&#x5728;&#x81EA;&#x5DF1;&#x7684;&#x7535;&#x8111;&#x548C; VPS &#x4E0A;&#x9762;&#x5B89;&#x88C5; <code>rsync</code>&#xFF0C;&#x9996;&#x5148;&#x8FDB;&#x5165;&#x4F60;&#x7684; Hexo &#x7AD9;&#x70B9;&#x76EE;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-meta">$</span><span class="bash"> npm i -s hexo-deployer-rsync</span></code></pre></figure></code></pre><p>&#x6839;&#x636E;&#x53D1;&#x884C;&#x7248;&#x4E0D;&#x540C;&#x4F7F;&#x7528;&#x4E0D;&#x540C;&#x7684;&#x547D;&#x4EE4;&#x5B89;&#x88C5; <code>rsync</code>&#xFF1A;</p>
<p>Archlinux / Manjaro / Antergos&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-meta">#</span><span class="bash"> pacman -S rsync</span></code></pre></figure></code></pre><p>Debian / Ubuntu / LinuxMint / Deepin&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-meta">#</span><span class="bash"> apt install rsync</span></code></pre></figure></code></pre><p>Red Hat / CentOS / Fedora&#xFF08;&#x5982;&#x679C;&#x627E;&#x4E0D;&#x5230; <code>yum</code> &#x5C31;&#x6362;&#x6210; <code>dnf</code>&#xFF09;&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-meta">#</span><span class="bash"> yum install rsync</span></code></pre></figure></code></pre><p>&#x63A5;&#x4E0B;&#x6765;&#x548C;&#x5F88;&#x591A;&#x7F51;&#x4E0A;&#x7684;&#x6587;&#x7AE0;&#x8BF4;&#x7684;&#x4E0D;&#x4E00;&#x6837;&#xFF0C;&#x5F88;&#x591A;&#x4EBA;&#x628A;&#x8FD9;&#x91CC;&#x7684;&#x8BBE;&#x7F6E;&#x7406;&#x89E3;&#x6210;&#x8981;&#x5728; VPS &#x4E0A;&#x9762;&#x5F00;&#x542F;&#x4E00;&#x4E2A; rsync &#x7684;&#x670D;&#x52A1;&#x5668;&#xFF0C;&#x5B9E;&#x9645;&#x4E0A;&#x4E0D;&#x662F;&#xFF0C;rsync&#x53EF;&#x4EE5;&#x901A;&#x8FC7;&#x4EFB;&#x610F;&#x4E00;&#x4E2A;&#x7528;&#x6237;&#x548C; ssh &#x5BC6;&#x94A5;&#x8FDE;&#x63A5;&#x5230;&#x670D;&#x52A1;&#x5668;&#x7136;&#x540E;&#x590D;&#x5236;&#x6587;&#x4EF6;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6253;&#x5F00; <strong>&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x7535;&#x8111;</strong> &#x4E0A;&#x7684; <code>~/.ssh/id_rsa.pub</code> &#x83B7;&#x53D6;&#x4F60;&#x81EA;&#x5DF1;&#x7684;&#x516C;&#x94A5;&#xFF08;&#x5F53;&#x7136;&#x4F60;&#x53EF;&#x80FD;&#x7528;&#x7684;&#x4E0D;&#x662F; RSA&#xFF0C;&#x81EA;&#x5DF1;&#x6539;&#xFF09;&#xFF0C;&#x7136;&#x540E;&#x590D;&#x5236;&#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x6DFB;&#x52A0;&#x5230; <strong>&#x670D;&#x52A1;&#x5668;</strong> &#x91CC;&#x9762;&#x4F60;&#x8981;&#x4F7F;&#x7528;&#x7684;&#x7528;&#x6237;&#xFF08;&#x4E0D;&#x5EFA;&#x8BAE; root &#x6562;&#x6B7B;&#x961F;&#xFF0C;&#x4F60;&#x5E73;&#x65F6;&#x7684;&#x7528;&#x6237;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#xFF09;&#x7684; <code>~/.ssh/authorized_keys</code> &#x6587;&#x4EF6;&#x91CC;&#xFF0C;&#x6BCF;&#x4E2A;&#x5BC6;&#x94A5;&#x5355;&#x72EC;&#x7C98;&#x8D34;&#x4E00;&#x884C;&#x3002;&#x5982;&#x679C;&#x4F60;&#x8BBE;&#x7F6E;&#x8FC7; ssh &#x514D;&#x5BC6;&#x7801;&#x767B;&#x5F55;&#x7684;&#x8BDD;&#xFF0C;&#x8FD9;&#x4E00;&#x6B65;&#x5E94;&#x8BE5;&#x505A;&#x8FC7;&#x4E86;&#x3002;</p>
<p>&#x7136;&#x540E;&#x6253;&#x5F00; Hexo &#x7AD9;&#x70B9;&#x7684; <code>_config.yml</code>&#xFF0C;&#x4FEE;&#x6539; <code>deploy</code> &#x5B57;&#x6BB5;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x6709;&#x8BBE;&#x7F6E;&#x8FC7;&#x7684;&#x8BDD;&#x90A3;&#x5C31;&#x6539;&#x6210;&#x8FD9;&#x6837;&#xFF1A;</p>
<pre><code class="yaml"><figure class="highlight hljs yaml"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
</pre><pre class="code"><code><span class="hljs-attr">deploy:</span>
<span class="hljs-attr">  type:</span> <span class="hljs-string">rsync</span>
<span class="hljs-attr">  host:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">VPS</span> <span class="hljs-string">IP</span> <span class="hljs-comment"># &#x4F60;&#x7684;&#x670D;&#x52A1;&#x5668;&#x7684; IP &#x5730;&#x5740;</span>
<span class="hljs-attr">  user:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">USERNAME</span> <span class="hljs-comment"># &#x4F60;&#x521A;&#x521A;&#x590D;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x90A3;&#x4E2A;&#x7528;&#x6237;</span>
<span class="hljs-attr">  root:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">DESTINATION</span> <span class="hljs-comment"># &#x4F60;&#x60F3;&#x628A;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5230;&#x54EA;&#x91CC;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x7684;&#x662F; `~/stackharbor.alynx.xyz/`</span>
<span class="hljs-attr">  port:</span> <span class="hljs-number">22</span> <span class="hljs-comment"># &#x8FD9;&#x662F; ssh &#x9ED8;&#x8BA4;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4FEE;&#x6539;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x4E5F;&#x8981;&#x6539;</span>
<span class="hljs-attr">  args:</span> <span class="hljs-bullet">--progress</span> <span class="hljs-comment"># &#x989D;&#x5916;&#x7684; rsync &#x53C2;&#x6570;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x8FDB;&#x5EA6;&#x6761;&#x53C2;&#x6570;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x8BBE;&#x7F6E;</span>
<span class="hljs-attr">  delete:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># &#x662F;&#x5426;&#x5220;&#x9664;&#x65E7;&#x7684;&#x6587;&#x4EF6;</span>
<span class="hljs-attr">  verbose:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># &#x662F;&#x5426;&#x540C;&#x6B65;&#x65F6;&#x663E;&#x793A;&#x8BE6;&#x7EC6;&#x72B6;&#x6001;</span>
<span class="hljs-attr">  ignore_errors:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># &#x5FFD;&#x7565;&#x9519;&#x8BEF;</span></code></pre></figure></code></pre>
<p>&#x5F53;&#x7136;&#x5F88;&#x591A;&#x4EBA;&#x53EF;&#x80FD;&#x5DF2;&#x7ECF;&#x6709;&#x4E00;&#x4E2A; git &#x7684;&#x90E8;&#x7F72;&#x8BBE;&#x7F6E;&#x4E86;&#xFF0C;&#x90A3;&#x4E5F;&#x5F88;&#x7B80;&#x5355;&#xFF0C;&#x8BBE;&#x7F6E;&#x6210;&#x4E00;&#x4E2A;&#x6570;&#x7EC4;&#x5C31;&#x884C;&#x4E86;&#xFF0C;&#x50CF;&#x8FD9;&#x6837;&#xFF1A;</p>
<pre><code class="yaml"><figure class="highlight hljs yaml"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
</pre><pre class="code"><code><span class="hljs-attr">deploy:</span>
<span class="hljs-attr">  - type:</span> <span class="hljs-string">git</span>
<span class="hljs-attr">    repo:</span> <span class="hljs-comment"># &#x50CF;&#x8FD9;&#x6837;&#x8BBE;&#x7F6E;&#x591A;&#x4E2A; git &#x4ED3;&#x5E93;&#xFF0C;`&#x540D;&#x79F0;: &#x5730;&#x5740;,&#x5206;&#x652F;`&#xFF0C;&#x9017;&#x53F7;&#x540E;&#x9762;&#x6CA1;&#x6709;&#x7A7A;&#x683C;&#x3002;</span>
<span class="hljs-attr">      github:</span> <span class="hljs-string">git@github.com:XXXXXX/XXXXXX.git,branch</span>
<span class="hljs-attr">      coding:</span> <span class="hljs-string">git@git.coding.net:XXXXXXX/XXXXXXX,coding-pages</span>
<span class="hljs-attr">    message:</span> <span class="hljs-string">Site</span> <span class="hljs-string">updated</span> <span class="hljs-string">by</span> <span class="hljs-string">Hexo</span> <span class="hljs-string">at</span> <span class="hljs-string">{{</span> <span class="hljs-string">now(&apos;YYYY-MM-DD</span> <span class="hljs-attr">HH:mm:ss&apos;)</span> <span class="hljs-string">}}.</span>
<span class="hljs-attr">  - type:</span> <span class="hljs-string">rsync</span>
<span class="hljs-attr">    host:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">VPS</span> <span class="hljs-string">IP</span> <span class="hljs-comment"># &#x4F60;&#x7684;&#x670D;&#x52A1;&#x5668;&#x7684; IP &#x5730;&#x5740;</span>
<span class="hljs-attr">    user:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">USERNAME</span> <span class="hljs-comment"># &#x4F60;&#x521A;&#x521A;&#x590D;&#x5236;&#x5BC6;&#x94A5;&#x7684;&#x90A3;&#x4E2A;&#x7528;&#x6237;</span>
<span class="hljs-attr">    root:</span> <span class="hljs-string">YOUR</span> <span class="hljs-string">DESTINATION</span> <span class="hljs-comment"># &#x4F60;&#x60F3;&#x628A;&#x6587;&#x4EF6;&#x4E0A;&#x4F20;&#x5230;&#x54EA;&#x91CC;&#xFF0C;&#x6BD4;&#x5982;&#x6211;&#x7684;&#x662F; `~/stackharbor.alynx.xyz/`</span>
<span class="hljs-attr">    port:</span> <span class="hljs-number">22</span> <span class="hljs-comment"># &#x8FD9;&#x662F; ssh &#x9ED8;&#x8BA4;&#x7684;&#x7AEF;&#x53E3;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x4FEE;&#x6539;&#x4E86;&#xFF0C;&#x8FD9;&#x91CC;&#x4E5F;&#x8981;&#x6539;</span>
<span class="hljs-attr">    args:</span> <span class="hljs-bullet">--progress</span> <span class="hljs-comment"># &#x989D;&#x5916;&#x7684; rsync &#x53C2;&#x6570;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x6DFB;&#x52A0;&#x4E86;&#x4E00;&#x4E2A;&#x8FDB;&#x5EA6;&#x6761;&#x53C2;&#x6570;&#xFF0C;&#x4F60;&#x4E5F;&#x53EF;&#x4EE5;&#x4E0D;&#x8BBE;&#x7F6E;</span>
<span class="hljs-attr">    delete:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># &#x662F;&#x5426;&#x5220;&#x9664;&#x65E7;&#x7684;&#x6587;&#x4EF6;</span>
<span class="hljs-attr">    verbose:</span> <span class="hljs-literal">true</span> <span class="hljs-comment"># &#x662F;&#x5426;&#x540C;&#x6B65;&#x65F6;&#x663E;&#x793A;&#x8BE6;&#x7EC6;&#x72B6;&#x6001;</span>
<span class="hljs-attr">    ignore_errors:</span> <span class="hljs-literal">false</span> <span class="hljs-comment"># &#x5FFD;&#x7565;&#x9519;&#x8BEF;</span></code></pre></figure></code></pre>
<p>&#x8FD9;&#x6837;&#x5C31;&#x884C;&#x4E86;&#xFF0C;&#x8FD0;&#x884C; <code>hexo deploy</code> &#x5E94;&#x8BE5;&#x5C31;&#x80FD;&#x770B;&#x5230; rsync &#x7684;&#x540C;&#x6B65;&#x72B6;&#x6001;&#x4E86;&#x3002;&#x5982;&#x679C;&#x4F60;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x4E0D;&#x4F7F;&#x7528; Hexo &#x7684;&#x7F51;&#x9875;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x547D;&#x4EE4;&#xFF1A;</p>
<pre><code><figure class="highlight hljs elixir"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-variable">$ </span>rsync -azv --delete SOURCE USERNAME<span class="hljs-variable">@IPADDRESS</span><span class="hljs-symbol">:DESTINATION</span></code></pre></figure></code></pre><!-- Marked bug: cannot handle `\)` in URL, use `%29` instead. Waiting hexo-renderer-marked update its dependents version. -->
<p>&#x4E0A;&#x4F20;&#x5230;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x5982;&#x679C;&#x6709; git &#x4ED3;&#x5E93;&#x6700;&#x597D;&#x7528; <code>--exclude=.git</code> &#x6392;&#x9664;&#x6389;&#xFF0C;&#x987A;&#x4FBF; SOURCE &#x76EE;&#x5F55;&#x4E00;&#x822C;&#x4E0D;&#x8981;&#x7528; <code>/</code> &#x7ED3;&#x5C3E;&#xFF0C;&#x539F;&#x56E0;&#x53C2;&#x89C1; [&#x8FD9;&#x91CC;](<a href="https://wiki.archlinux.org/index.php/Rsync_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29#.E6.B3.A8.E6.84.8F.E5.B0.BE.E9.9A.8F.E4.B8.8B.E5.88.92)%E3%80%82" target="_blank">https://wiki.archlinux.org/index.php/Rsync_(%E7%AE%80%E4%BD%93%E4%B8%AD%E6%96%87%29#.E6.B3.A8.E6.84.8F.E5.B0.BE.E9.9A.8F.E4.B8.8B.E5.88.92)&#x3002;</a></p>
<p>&#x8FD9;&#x4E2A;&#x65F6;&#x5019;&#x6211;&#x8FD8;&#x6CA1;&#x6709;&#x628A; DNS &#x4ECE; GitHub Pages &#x8F6C;&#x5230;&#x6211;&#x7684;&#x670D;&#x52A1;&#x5668;&#x4E0A;&#xFF0C;&#x7ED3;&#x679C;&#x751F;&#x7C73;&#x716E;&#x6210;&#x4E86;&#x719F;&#x996D;&#xFF0C;&#x53EA;&#x80FD;&#x5F80;&#x4E0B;&#x7EE7;&#x7EED;&#x4E86;&#x3002;</p>
<h1 id="&#x7528;Let039;sEncrypt&#x751F;&#x6210;SSL&#x8BC1;&#x4E66;"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E7%94%A8Let039;sEncrypt%E7%94%9F%E6%88%90SSL%E8%AF%81%E4%B9%A6" title="&#x7528;Let039;sEncrypt&#x751F;&#x6210;SSL&#x8BC1;&#x4E66;"></a>&#x7528; Let&apos;s Encrypt &#x751F;&#x6210; SSL &#x8BC1;&#x4E66;</h1>
<p>HTTPS &#x9700;&#x8981;&#x6709;&#x53EF;&#x4FE1;&#x673A;&#x6784;&#x7B7E;&#x53D1;&#x7684;&#x8BC1;&#x4E66;&#xFF0C;<a href="https://letsencrypt.org/" target="_blank">Let&apos;s Encrypt</a> &#x5C31;&#x662F;&#x4E00;&#x4E2A;&#x514D;&#x8D39;&#x63D0;&#x4F9B;&#x8FD9;&#x79CD;&#x670D;&#x52A1;&#x7684;&#x7F51;&#x7AD9;&#xFF0C;&#x4E0D;&#x8FC7;&#x5B98;&#x65B9;&#x63A8;&#x8350;&#x7684;&#x6B65;&#x9AA4;&#x53EA;&#x80FD;&#x5BF9;&#x6BCF;&#x4E2A;&#x57DF;&#x540D;&#x5355;&#x72EC;&#x751F;&#x6210;&#x8BC1;&#x4E66;&#xFF0C;&#x6BD4;&#x5982; <code>alynx.xyz</code> &#x548C; <code>sh.alynx.xyz</code> &#x9700;&#x8981;&#x4E24;&#x4E2A;&#x8BC1;&#x4E66;&#xFF0C;&#x8FD9;&#x91CC;&#x4ECB;&#x7ECD;&#x751F;&#x6210;&#x901A;&#x914D;&#x7B26;&#x8BC1;&#x4E66;&#x7684;&#x529E;&#x6CD5;&#xFF0C;&#x6BD4;&#x5982;&#x5BF9; <code>*.alynx.xyz</code> &#x751F;&#x6210;&#x4E00;&#x4E2A;&#x8BC1;&#x4E66;&#xFF0C;&#x53EF;&#x4EE5;&#x7528;&#x5728;&#x6240;&#x6709;&#x4E09;&#x7EA7;&#x5B50;&#x57DF;&#x540D;&#xFF1A;</p>
<h2 id="&#x4E0B;&#x8F7D;certbot-auto"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E4%B8%8B%E8%BD%BDcertbot-auto" title="&#x4E0B;&#x8F7D;certbot-auto"></a>&#x4E0B;&#x8F7D; certbot-auto</h2>
<p><code>certbot-auto</code> &#x662F;&#x7528;&#x6765;&#x9A8C;&#x8BC1;&#x751F;&#x6210;&#x8BC1;&#x4E66;&#x7684;&#x4EA4;&#x4E92;&#x547D;&#x4EE4;&#x884C;&#x5DE5;&#x5177;&#xFF0C;&#x4F3C;&#x4E4E;&#x4E00;&#x822C;&#x8F6F;&#x4EF6;&#x6E90;&#x91CC;&#x7684;&#x7248;&#x672C;&#x90FD;&#x4E0D;&#x591F;&#x9AD8;&#xFF0C;&#x4E0D;&#x80FD;&#x751F;&#x6210;&#x901A;&#x914D;&#x7B26;&#x8BC1;&#x4E66;&#xFF0C;&#x8FD9;&#x91CC;&#x624B;&#x52A8;&#x4E0B;&#x8F7D;&#x65B0;&#x7248;&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
</pre><pre class="code"><code><span class="hljs-meta">$</span><span class="bash"> wget https://dl.eff.org/certbot-auto</span>
<span class="hljs-meta">$</span><span class="bash"> chmod +x ./certbot-auto</span></code></pre></figure></code></pre><h2 id="&#x624B;&#x52A8;&#x751F;&#x6210;&#x8BC1;&#x4E66;"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E6%89%8B%E5%8A%A8%E7%94%9F%E6%88%90%E8%AF%81%E4%B9%A6" title="&#x624B;&#x52A8;&#x751F;&#x6210;&#x8BC1;&#x4E66;"></a>&#x624B;&#x52A8;&#x751F;&#x6210;&#x8BC1;&#x4E66;</h2>
<p>&#x751F;&#x6210;&#x8BC1;&#x4E66;&#x7684;&#x8BDD;&#x9700;&#x8981;&#x6211;&#x4EEC;&#x624B;&#x52A8;&#x64CD;&#x4F5C;&#xFF0C;&#x547D;&#x4EE4;&#x5982;&#x4E0B;&#xFF08;&#x7528;&#x4F60;&#x7684;&#x57DF;&#x540D;&#x66FF;&#x6362;&#x6389; <code>example.com</code>&#xFF09;&#xFF1A;</p>
<pre><code><figure class="highlight hljs brainfuck"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-comment">#</span> <span class="hljs-string">.</span><span class="hljs-comment">/certbot</span><span class="hljs-literal">-</span><span class="hljs-comment">auto</span> <span class="hljs-comment">certonly</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">manual</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">preferred</span><span class="hljs-literal">-</span><span class="hljs-comment">challenges=dns</span> <span class="hljs-literal">-</span><span class="hljs-literal">-</span><span class="hljs-comment">server=https://acme</span><span class="hljs-literal">-</span><span class="hljs-comment">v02</span><span class="hljs-string">.</span><span class="hljs-comment">api</span><span class="hljs-string">.</span><span class="hljs-comment">letsencrypt</span><span class="hljs-string">.</span><span class="hljs-comment">org/directory</span> <span class="hljs-literal">-</span><span class="hljs-comment">d</span> <span class="hljs-comment">*</span><span class="hljs-string">.</span><span class="hljs-comment">example</span><span class="hljs-string">.</span><span class="hljs-comment">com</span> <span class="hljs-literal">-</span><span class="hljs-comment">d</span> <span class="hljs-comment">example</span><span class="hljs-string">.</span><span class="hljs-comment">com</span></code></pre></figure></code></pre><p>&#x8FD9;&#x91CC; <code>certonly</code> &#x8868;&#x793A;&#x6211;&#x4EEC;&#x53EA;&#x9700;&#x8981;&#x751F;&#x6210;&#x8BC1;&#x4E66;&#xFF0C;&#x6211;&#x4EEC;&#x4E0D;&#x9700;&#x8981;&#x5B83;&#x5E2E;&#x6211;&#x4EEC;&#x6539;&#x670D;&#x52A1;&#x5668;&#x914D;&#x7F6E;&#x3002;<code>--manual</code> &#x8868;&#x793A;&#x624B;&#x52A8;&#x914D;&#x7F6E;&#x53C2;&#x6570;&#x3002;&#x751F;&#x6210;&#x8BC1;&#x4E66;&#x9700;&#x8981;&#x4F60;&#x8BC1;&#x660E;&#x57DF;&#x540D;&#x5C5E;&#x4E8E;&#x4F60;&#xFF0C;&#x7531;&#x4E8E;&#x6211;&#x4EEC;&#x662F;&#x901A;&#x914D;&#x7B26;&#x81EA;&#x7136;&#x4E0D;&#x80FD;&#x4E00;&#x4E2A;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x53BB;&#x653E;&#x6587;&#x4EF6;&#x9A8C;&#x8BC1;&#xFF08;&#x9ED8;&#x8BA4;&#x7684;&#x9A8C;&#x8BC1;&#x65B9;&#x6CD5;&#xFF0C;&#x7C7B;&#x4F3C; Google &#x7684;&#x9875;&#x9762;&#x9A8C;&#x8BC1;&#xFF09;&#xFF0C;&#x6240;&#x4EE5;&#x7528; <code>--preferred-challenges=dns</code> &#x8BBE;&#x7F6E;&#x4E3A;&#x9A8C;&#x8BC1; DNS &#x8BB0;&#x5F55;&#x3002;<code>--server=https://acme-v02.api.letsencrypt.org/directory</code> &#x8868;&#x793A;&#x4F7F;&#x7528;&#x7B2C;&#x4E8C;&#x7248;&#x7684; api &#x670D;&#x52A1;&#x5668;&#xFF0C;&#x9ED8;&#x8BA4;&#x7684;&#x7B2C;&#x4E00;&#x7248;&#x662F;&#x4E0D;&#x652F;&#x6301;&#x901A;&#x914D;&#x7B26;&#x8BC1;&#x4E66;&#x7684;&#x7B7E;&#x53D1;&#x7684;&#x3002;&#x6700;&#x540E; <code>-d *.example.com -d example.com</code> &#x6DFB;&#x52A0;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x9700;&#x8981;&#x6CE8;&#x610F;&#x7684;&#x662F;&#x53EA;&#x5305;&#x542B; <code>*.example.com</code> &#x7684;&#x8BC1;&#x4E66;&#x662F;&#x4E0D;&#x80FD;&#x7528;&#x5728; <code>example.com</code> &#x4E0A;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x6211;&#x4EEC;&#x628A;&#x4E24;&#x4E2A;&#x90FD;&#x5199;&#x4E0A;&#xFF0C;&#x751F;&#x6210;&#x7684;&#x8BC1;&#x4E66;&#x5C31;&#x4F1A;&#x540C;&#x65F6;&#x5305;&#x542B;&#x4E24;&#x4E2A;&#x57DF;&#x540D;&#x3002;</p>
<pre><code><figure class="highlight hljs lasso"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
</pre><pre class="code"><code>Saving debug <span class="hljs-keyword">log</span> <span class="hljs-keyword">to</span> /<span class="hljs-built_in">var</span>/<span class="hljs-keyword">log</span>/letsencrypt/letsencrypt.<span class="hljs-keyword">log</span>
Plugins selected: Authenticator manual, Installer <span class="hljs-literal">None</span>
Enter email address (used for urgent renewal <span class="hljs-literal">and</span> security notices) (Enter <span class="hljs-string">&apos;c&apos;</span> <span class="hljs-keyword">to</span>
cancel): YOUR EMAIL</code></pre></figure></code></pre><p>&#x8FD9;&#x91CC;&#x4F1A;&#x8BA9;&#x4F60;&#x8F93;&#x5165;&#x4F60;&#x7684;&#x90AE;&#x7BB1;&#x3002;</p>
<pre><code><figure class="highlight hljs livecodeserver"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
</pre><pre class="code"><code><span class="hljs-comment">-------------------------------------------------------------------------------</span>
Please <span class="hljs-built_in">read</span> <span class="hljs-keyword">the</span> Terms <span class="hljs-keyword">of</span> Service <span class="hljs-keyword">at</span>
<span class="hljs-keyword">https</span>://letsencrypt.org/documents/LE-SA-v1<span class="hljs-number">.2</span>-November<span class="hljs-number">-15</span><span class="hljs-number">-2017.</span>pdf. You must
agree <span class="hljs-keyword">in</span> order <span class="hljs-built_in">to</span> register <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> ACME server <span class="hljs-keyword">at</span>
<span class="hljs-keyword">https</span>://acme-v02.api.letsencrypt.org/<span class="hljs-built_in">directory</span>
<span class="hljs-comment">-------------------------------------------------------------------------------</span>
(A)gree/(C)ancel: A</code></pre></figure></code></pre><p>&#x8FD9;&#x91CC;&#x8F93;&#x5165; A &#x8868;&#x793A;&#x540C;&#x610F;&#x6761;&#x6B3E;&#x3002;</p>
<pre><code><figure class="highlight hljs applescript"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
</pre><pre class="code"><code><span class="hljs-comment">-------------------------------------------------------------------------------</span>
Would you be willing <span class="hljs-keyword">to</span> share your email address <span class="hljs-keyword">with</span> <span class="hljs-keyword">the</span> Electronic Frontier
Foundation, a founding partner <span class="hljs-keyword">of</span> <span class="hljs-keyword">the</span> Let&apos;s Encrypt project <span class="hljs-keyword">and</span> <span class="hljs-keyword">the</span> non-profit
organization <span class="hljs-keyword">that</span> develops Certbot? We&apos;d like <span class="hljs-keyword">to</span> send you email <span class="hljs-keyword">about</span> EFF <span class="hljs-keyword">and</span>
our work <span class="hljs-keyword">to</span> encrypt <span class="hljs-keyword">the</span> web, protect <span class="hljs-keyword">its</span> users <span class="hljs-keyword">and</span> defend digital rights.
<span class="hljs-comment">-------------------------------------------------------------------------------</span>
(Y)es/(N)o: N</code></pre></figure></code></pre><p>&#x8FD9;&#x91CC;&#x95EE;&#x4F60;&#x8981;&#x4E0D;&#x8981;&#x628A;&#x90AE;&#x7BB1;&#x53D1;&#x7ED9; EFF&#xFF0C;&#x6211;&#x4E0D;&#x60F3;&#x53D1;&#x5C31;&#x8F93;&#x5165;&#x4E86; N&#x3002;</p>
<pre><code><figure class="highlight hljs applescript"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
</pre><pre class="code"><code>Obtaining a new certificate
Performing <span class="hljs-keyword">the</span> following challenges:
dns<span class="hljs-number">-01</span> challenge <span class="hljs-keyword">for</span> alynx.xyz
dns<span class="hljs-number">-01</span> challenge <span class="hljs-keyword">for</span> alynx.xyz

<span class="hljs-comment">-------------------------------------------------------------------------------</span>
NOTE: The IP <span class="hljs-keyword">of</span> this machine will be publicly logged <span class="hljs-keyword">as</span> having requested this
certificate. If you&apos;re <span class="hljs-built_in">running</span> certbot <span class="hljs-keyword">in</span> manual mode <span class="hljs-keyword">on</span> a machine <span class="hljs-keyword">that</span> <span class="hljs-keyword">is</span> <span class="hljs-keyword">not</span>
your server, please ensure you&apos;re okay <span class="hljs-keyword">with</span> <span class="hljs-keyword">that</span>.

Are you OK <span class="hljs-keyword">with</span> your IP being logged?
<span class="hljs-comment">-------------------------------------------------------------------------------</span>
(Y)es/(N)o: Y</code></pre></figure></code></pre><p>&#x8FD9;&#x91CC;&#x663E;&#x793A;&#x4E86;&#x9700;&#x8981;&#x9A8C;&#x8BC1;&#x7684;&#x6B21;&#x6570;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x4EEC;&#x6709;&#x4E24;&#x4E2A;&#x6240;&#x4EE5;&#x8981;&#x9A8C;&#x8BC1;&#x4E24;&#x6B21;&#xFF0C;&#x7136;&#x540E;&#x4E3A;&#x4E86;&#x9650;&#x5236;&#x7533;&#x8BF7;&#x6B21;&#x6570;&#x9632;&#x6B62;&#x5237;&#x8BC1;&#x4E66;&#xFF0C;&#x8FD9;&#x91CC;&#x5B83;&#x4F1A;&#x8BB0;&#x5F55;&#x4F60;&#x7533;&#x8BF7;&#x8BC1;&#x4E66;&#x7684; IP&#xFF0C;&#x8F93;&#x5165; Y&#x3002;</p>
<pre><code><figure class="highlight hljs routeros"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
</pre><pre class="code"><code>-------------------------------------------------------------------------------
Please deploy a<span class="hljs-built_in"> DNS </span>TXT record under the name
_acme-challenge.alynx.xyz with the following value:

YX3oQEVGxLolEVtiFDF4JCKe1tqB7B-9pwis8zuQZkc

Before continuing, verify the record is deployed.
-------------------------------------------------------------------------------
Press Enter <span class="hljs-keyword">to</span> Continue</code></pre></figure></code></pre><p>&#x8FD9;&#x91CC;&#x662F;&#x7B2C;&#x4E00;&#x6B21;&#x9A8C;&#x8BC1;&#xFF0C;&#x5148;&#x522B;&#x6025;&#x7740;&#x56DE;&#x8F66;&#xFF0C;&#x53BB;&#x4F60;&#x7684; DNS &#x670D;&#x52A1;&#x5546;&#x90A3;&#x91CC;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x5230; <code>_acme-challenge</code> &#x7684;&#x5185;&#x5BB9;&#x4E3A; <code>YX3oQEVGxLolEVtiFDF4JCKe1tqB7B-9pwis8zuQZkc</code>&#xFF08;&#x4F60;&#x7684;&#x5185;&#x5BB9;&#x4E0D;&#x4E00;&#x5B9A;&#x548C;&#x6211;&#x7684;&#x4E00;&#x6837;&#xFF09;&#x7684; TXT &#x8BB0;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x7528; <code>dig -t txt _acme-challenge.example.com @8.8.8.8</code>&#xFF0C;&#x68C0;&#x67E5;&#x662F;&#x5426;&#x66F4;&#x65B0;&#x5B8C;&#x6210;&#xFF0C;&#x6700;&#x597D;&#x591A;&#x67E5;&#x51E0;&#x6B21;&#xFF0C;&#x9632;&#x6B62;&#x7F13;&#x5B58;&#x5BFC;&#x81F4;&#x5931;&#x8D25;&#x3002;&#x6709;&#x6D88;&#x606F;&#x8BF4;&#x56FD;&#x5185;&#x7684; DNS &#x662F;&#x8BBF;&#x95EE;&#x4E0D;&#x5230;&#x7684;&#xFF0C;&#x6211;&#x8FD9;&#x91CC;&#x7528;&#x7684; CloudFlare&#x3002;</p>
<pre><code><figure class="highlight hljs vhdl"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
</pre><pre class="code"><code><span class="hljs-comment">-------------------------------------------------------------------------------</span>
Please deploy a DNS TXT <span class="hljs-keyword">record</span> under the name
_acme-challenge.alynx.xyz <span class="hljs-keyword">with</span> the following value:

lKuF76a3GRy7y3M-FVDJ3kif0FQJJwZQUROc6cgG_lk

Before continuing, verify the <span class="hljs-keyword">record</span> <span class="hljs-keyword">is</span> deployed.
<span class="hljs-comment">-------------------------------------------------------------------------------</span>
Press Enter <span class="hljs-keyword">to</span> Continue
Waiting <span class="hljs-keyword">for</span> verification...
Cleaning up challenges

IMPORTANT NOTES:
 - Congratulations! Your certificate <span class="hljs-keyword">and</span> chain have been saved at:
   /etc/letsencrypt/live/example.com/fullchain.pem
   Your key <span class="hljs-keyword">file</span> has been saved at:
   /etc/letsencrypt/live/example.com/privkey.pem
   Your cert will expire <span class="hljs-keyword">on</span> <span class="hljs-number">2018</span>-<span class="hljs-number">09</span>-<span class="hljs-number">02</span>. <span class="hljs-keyword">To</span> obtain a <span class="hljs-keyword">new</span> <span class="hljs-keyword">or</span> tweaked
   version <span class="hljs-keyword">of</span> this certificate <span class="hljs-keyword">in</span> the future, simply run certbot-auto
   again. <span class="hljs-keyword">To</span> non-interactively renew *<span class="hljs-keyword">all</span>* <span class="hljs-keyword">of</span> your certificates, run
   <span class="hljs-string">&quot;certbot-auto renew&quot;</span>
 - <span class="hljs-keyword">If</span> you like Certbot, please consider supporting our work by:

   Donating <span class="hljs-keyword">to</span> ISRG / Let<span class="hljs-symbol">&apos;s</span> Encrypt:   https://letsencrypt.org/donate
   Donating <span class="hljs-keyword">to</span> EFF:                    https://eff.org/donate-le</code></pre></figure></code></pre><p><del>&#x53C8;&#x662F;&#x4E00;&#x6B21;&#x9A8C;&#x8BC1;&#xFF0C;&#x628A;&#x521A;&#x624D;&#x7684;&#x8BB0;&#x5F55;&#x5185;&#x5BB9;&#x6539;&#x6210;&#x65B0;&#x7684;&#xFF0C;</del> &#x6309;&#x7167;&#x8BC4;&#x8BBA;&#x7684;&#x6307;&#x6B63;&#xFF0C;&#x8FD9;&#x91CC;&#x662F;&#x53EF;&#x4EE5;&#x5EFA;&#x7ACB;&#x4E24;&#x4E2A;&#x540C;&#x540D;&#x8BB0;&#x5F55;&#x7684;&#xFF0C;&#x6240;&#x4EE5;&#x4E0D;&#x9700;&#x8981;&#x4FEE;&#x6539;&#x4E24;&#x6B21;&#xFF0C;&#x8FD9;&#x91CC;&#x53EF;&#x4EE5;&#x518D;&#x6DFB;&#x52A0;&#x4E00;&#x6761;&#x540C;&#x6837;&#x540D;&#x5B57;&#x4F46;&#x5185;&#x5BB9;&#x4E0D;&#x540C;&#x7684;&#x8BB0;&#x5F55;&#xFF0C;&#x7136;&#x540E;&#x591A; <code>dig</code> &#x51E0;&#x6B21;&#x518D;&#x56DE;&#x8F66;&#xFF0C;&#x5982;&#x679C;&#x6CA1;&#x901A;&#x8FC7;&#x91CD;&#x65B0;&#x8FD0;&#x884C;&#x547D;&#x4EE4;&#x4F1A;&#x4ECE;&#x8BB0;&#x5F55; IP &#x90A3;&#x91CC;&#x5F00;&#x59CB;&#x3002;</p>
<p>&#x9700;&#x8981;&#x6CE8;&#x610F; certbot &#x4F3C;&#x4E4E;&#x4F1A;&#x5F88;&#x5F31;&#x667A;&#x7684;&#x7528; Nginx &#x670D;&#x52A1;&#x7684;&#x76EE;&#x5F55;&#x7684;&#x540D;&#x5B57;&#x4F5C;&#x4E3A;&#x5B83;&#x8BA4;&#x4E3A;&#x7684;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x6240;&#x4EE5;&#x6700;&#x597D;&#x5728;&#x5F00;&#x542F; Nginx &#x4E4B;&#x524D;&#x8BBE;&#x7F6E;&#x5B83;&#xFF0C;&#x5B83;&#x6BCF;&#x6B21;&#x90FD;&#x628A;&#x6211;&#x7684;&#x57DF;&#x540D;&#x5F53;&#x6210; <code>stackharbor.alynx.xyz</code> &#x4E5F;&#x662F;&#x628A;&#x6211;&#x6C14;&#x4E2A;&#x534A;&#x6B7B;&#x3002;</p>
<h1 id="&#x8BBE;&#x7F6E;Nginx"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E8%AE%BE%E7%BD%AENginx" title="&#x8BBE;&#x7F6E;Nginx"></a>&#x8BBE;&#x7F6E; Nginx</h1>
<p>&#x8FD9;&#x91CC;&#x7A0D;&#x5FAE;&#x590D;&#x6742;&#x4E00;&#x70B9;&#x5566;&#xFF0C;&#x56E0;&#x4E3A;&#x6211;&#x8FD8;&#x6709;&#x53E6;&#x4E00;&#x4E2A;&#x9875;&#x9762;&#x3002;</p>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x5B89;&#x88C5; Nginx&#xFF0C;&#x6211;&#x7684;&#x4E60;&#x60EF;&#x80AF;&#x5B9A;&#x662F;&#x5B89;&#x88C5;&#x5305;&#x7BA1;&#x7406;&#x91CC;&#x9762;&#x7684;&#x7136;&#x540E;&#x7528; systemd &#x7BA1;&#x7406;&#xFF0C;&#x6211;&#x662F; Debian9&#xFF0C;&#x4F60;&#x4EEC;&#x770B;&#x7740;&#x6765;&#x3002;</p>
<h2 id="&#x5F3A;&#x5236;HTTPS"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E5%BC%BA%E5%88%B6HTTPS" title="&#x5F3A;&#x5236;HTTPS"></a>&#x5F3A;&#x5236; HTTPS</h2>
<p>&#x9996;&#x5148;&#x6211;&#x4EEC;&#x8981;&#x628A;&#x6240;&#x6709;&#x7684; HTTP &#x8BF7;&#x6C42;&#x5B9A;&#x5411;&#x5230; HTTPS &#x4E0A;&#xFF0C;&#x7F16;&#x8F91; <code>/etc/nginx/nginx.conf</code>&#xFF0C;&#x5728; <code>include /etc/nginx/sites-enabled/*;</code> &#x524D;&#x9762;&#x63D2;&#x5165;&#xFF1A;</p>
<pre><code class="lua"><figure class="highlight hljs lua"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre><pre class="code"><code># Forward all HTTP requests to HTTPS.
server {
    listen <span class="hljs-number">80</span> default_server;
    listen [::]:<span class="hljs-number">80</span> default_server;
    <span class="hljs-keyword">return</span> <span class="hljs-number">301</span> https://$host$request_uri;
}</code></pre></figure></code></pre>
<p>&#x8FD9;&#x6BB5;&#x8868;&#x793A;&#x6240;&#x6709; 80 &#x7AEF;&#x53E3;&#x7684;&#x8BF7;&#x6C42;&#x90FD;&#x88AB; 301 &#x6C38;&#x4E45;&#x91CD;&#x5B9A;&#x5411;&#x5230; https &#x7684;&#x7F51;&#x5740;&#x4E0A;&#x9762;&#x3002;</p>
<h2 id="&#x914D;&#x7F6E;&#x865A;&#x62DF;&#x4E3B;&#x673A;"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E9%85%8D%E7%BD%AE%E8%99%9A%E6%8B%9F%E4%B8%BB%E6%9C%BA" title="&#x914D;&#x7F6E;&#x865A;&#x62DF;&#x4E3B;&#x673A;"></a>&#x914D;&#x7F6E;&#x865A;&#x62DF;&#x4E3B;&#x673A;</h2>
<p>&#x7136;&#x540E;&#x5728; <code>/etc/nginx/sites-available/</code> &#x4E0B;&#x9762;&#x521B;&#x5EFA;&#x4E00;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x540D;&#x5B57;&#x53EF;&#x4EE5;&#x968F;&#x610F;&#xFF0C;&#x6211;&#x7528;&#x7684;&#x662F;&#x6211;&#x7684;&#x57DF;&#x540D;&#xFF0C;&#x7136;&#x540E;&#x7F16;&#x8F91;&#x5B83;&#xFF1A;</p>
<pre><code class="lua"><figure class="highlight hljs lua"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
<span class="line">11</span>
<span class="line">12</span>
<span class="line">13</span>
<span class="line">14</span>
<span class="line">15</span>
<span class="line">16</span>
<span class="line">17</span>
<span class="line">18</span>
<span class="line">19</span>
<span class="line">20</span>
<span class="line">21</span>
<span class="line">22</span>
<span class="line">23</span>
<span class="line">24</span>
<span class="line">25</span>
<span class="line">26</span>
<span class="line">27</span>
<span class="line">28</span>
<span class="line">29</span>
<span class="line">30</span>
<span class="line">31</span>
<span class="line">32</span>
<span class="line">33</span>
<span class="line">34</span>
<span class="line">35</span>
<span class="line">36</span>
<span class="line">37</span>
<span class="line">38</span>
<span class="line">39</span>
<span class="line">40</span>
<span class="line">41</span>
<span class="line">42</span>
<span class="line">43</span>
<span class="line">44</span>
<span class="line">45</span>
<span class="line">46</span>
<span class="line">47</span>
<span class="line">48</span>
<span class="line">49</span>
<span class="line">50</span>
<span class="line">51</span>
<span class="line">52</span>
<span class="line">53</span>
<span class="line">54</span>
<span class="line">55</span>
<span class="line">56</span>
<span class="line">57</span>
<span class="line">58</span>
<span class="line">59</span>
<span class="line">60</span>
</pre><pre class="code"><code># Forward www domain to non-www domain.
server {
    # Must set ssl with a HTTPS request.
    listen <span class="hljs-number">443</span> ssl http2;
    listen [::]:<span class="hljs-number">443</span> ssl http2;

    ssl_certificate /etc/letsencrypt/live/alynx.xyz/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/alynx.xyz/privkey.pem;
    ssl_dhparam /etc/ssl/certs/dhparam.pem;
    ssl_ciphers <span class="hljs-string">&apos;ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS&apos;</span>;
    ssl_prefer_server_ciphers on;
    ssl_protocols TLSv1 TLSv1<span class="hljs-number">.1</span> TLSv1<span class="hljs-number">.2</span>;
    ssl_session_cache shared:SSL:<span class="hljs-number">50</span>m;
    ssl_session_timeout <span class="hljs-number">1</span>d;
    ssl_stapling on;
    ssl_stapling_verify on;
    ssl_trusted_certificate /etc/letsencrypt/live/alynx.xyz/fullchain.pem;
    add_header Strict-Transport-Security <span class="hljs-built_in">max</span>-age=<span class="hljs-number">60</span>;

    server_name www.example.com;
    <span class="hljs-keyword">return</span> <span class="hljs-number">301</span> https://example.com$request_uri;
}

server {
    # SSL configuration
    listen <span class="hljs-number">443</span> ssl http2;
    listen [::]:<span class="hljs-number">443</span> ssl http2;

    ssl_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    ssl_certificate_key /etc/letsencrypt/live/example.com/privkey.pem;
    ssl_dhparam /etc/ssl/certs/dhparam.pem;
    ssl_ciphers <span class="hljs-string">&apos;ECDHE-ECDSA-CHACHA20-POLY1305:ECDHE-RSA-CHACHA20-POLY1305:ECDHE-ECDSA-AES128-GCM-SHA256:ECDHE-RSA-AES128-GCM-SHA256:ECDHE-ECDSA-AES256-GCM-SHA384:ECDHE-RSA-AES256-GCM-SHA384:DHE-RSA-AES128-GCM-SHA256:DHE-RSA-AES256-GCM-SHA384:ECDHE-ECDSA-AES128-SHA256:ECDHE-RSA-AES128-SHA256:ECDHE-ECDSA-AES128-SHA:ECDHE-RSA-AES256-SHA384:ECDHE-RSA-AES128-SHA:ECDHE-ECDSA-AES256-SHA384:ECDHE-ECDSA-AES256-SHA:ECDHE-RSA-AES256-SHA:DHE-RSA-AES128-SHA256:DHE-RSA-AES128-SHA:DHE-RSA-AES256-SHA256:DHE-RSA-AES256-SHA:ECDHE-ECDSA-DES-CBC3-SHA:ECDHE-RSA-DES-CBC3-SHA:EDH-RSA-DES-CBC3-SHA:AES128-GCM-SHA256:AES256-GCM-SHA384:AES128-SHA256:AES256-SHA256:AES128-SHA:AES256-SHA:DES-CBC3-SHA:!DSS&apos;</span>;
    ssl_prefer_server_ciphers on;
    ssl_protocols TLSv1 TLSv1<span class="hljs-number">.1</span> TLSv1<span class="hljs-number">.2</span>;
    ssl_session_cache shared:SSL:<span class="hljs-number">50</span>m;
    ssl_session_timeout <span class="hljs-number">1</span>d;
    ssl_stapling on;
    ssl_stapling_verify on;
    ssl_trusted_certificate /etc/letsencrypt/live/example.com/fullchain.pem;
    add_header Strict-Transport-Security <span class="hljs-built_in">max</span>-age=<span class="hljs-number">60</span>;

    # Note: You should disable gzip <span class="hljs-keyword">for</span> SSL traffic.
    # See: https://bugs.debian.org/<span class="hljs-number">773332</span>
    #
    # Read up on ssl_ciphers to ensure a secure configuration.
    # See: https://bugs.debian.org/<span class="hljs-number">765782</span>

    root /home/example/example.com/;

    # Add index.php to the list <span class="hljs-keyword">if</span> you are using PHP
    index index.html index.htm index.nginx-debian.html;
    error_page <span class="hljs-number">404</span> <span class="hljs-number">404.</span>html;
    server_name example.com;

    location / {
        # First attempt to serve request as file, <span class="hljs-keyword">then</span>
        # as directory, <span class="hljs-keyword">then</span> fall back to displaying a <span class="hljs-number">404.</span>
        try_files $uri $uri/ =<span class="hljs-number">404</span>;
    }
}</code></pre></figure></code></pre>
<p>&#x9996;&#x5148;&#x4F60;&#x770B;&#x5230;&#x7684; ssl &#x90A3;&#x4E00;&#x5927;&#x7247;&#x90FD;&#x662F;&#x7528;&#x6765;&#x52A0;&#x5BC6;&#x7684;&#xFF0C;&#x603B;&#x4E4B;&#x4F60;&#x9700;&#x8981;&#x628A; example.com &#x6362;&#x6210;&#x4F60;&#x7684;&#x57DF;&#x540D;&#xFF08;&#x56E0;&#x4E3A; certbot &#x751F;&#x6210;&#x7684;&#x8BC1;&#x4E66;&#x6240;&#x5728;&#x7684;&#x76EE;&#x5F55;&#x662F;&#x57DF;&#x540D;&#x7684;&#x540D;&#x5B57;&#xFF09;&#x3002;&#x7136;&#x540E;&#x8FD9;&#x91CC;&#x7B2C;&#x4E00;&#x4E2A; server &#x7684;&#x4F5C;&#x7528;&#x662F;&#x628A; <code>www.example.com</code> &#x91CD;&#x5B9A;&#x5411;&#x5230; <code>example.com</code>&#xFF08;&#x56E0;&#x4E3A; 80 &#xFF08;HTTP&#xFF09;&#x5DF2;&#x7ECF;&#x88AB;&#x5F3A;&#x5236;&#x8F6C;&#x5230; 443 &#xFF08;HTTPS&#xFF09;&#x4E86;&#x6240;&#x4EE5;&#x4E00;&#x5B9A;&#x8981;&#x5199; 443 &#x548C; ssl &#x7684;&#x914D;&#x7F6E;&#xFF09;&#xFF0C;&#x5982;&#x679C;&#x4F60;&#x60F3;&#x53CD;&#x8FC7;&#x6765;&#xFF0C;&#x90A3;&#x5C31;&#x628A; <code>return</code> &#x90A3;&#x4E00;&#x53E5;&#x52A0;&#x4E0A; <code>www.</code> &#x7136;&#x540E;&#x628A;&#x4E0A;&#x4E0B;&#x4E24;&#x5757;&#x7684; <code>server_name</code> &#x90A3;&#x4E00;&#x884C;&#x5BF9;&#x8C03;&#x3002;</p>
<p><code>root</code> &#x9009;&#x9879;&#x8BBE;&#x7F6E;&#x6210;&#x4F60;&#x8981;&#x4F5C;&#x4E3A;&#x7F51;&#x9875;&#x76EE;&#x5F55;&#x7684;&#x8DEF;&#x5F84;&#xFF0C;&#x6BD4;&#x5982;&#x4E4B;&#x524D;&#x4F60; Hexo &#x4E0A;&#x4F20;&#x5230;&#x4E86;&#x5BB6;&#x76EE;&#x5F55;&#x4E0B;&#x7684;&#x5B50;&#x76EE;&#x5F55;&#x8FD9;&#x91CC;&#x8981;&#x5BF9;&#x5E94;&#x3002;</p>
<p>&#x63A5;&#x4E0B;&#x6765;&#x521B;&#x5EFA;&#x5BC6;&#x94A5;&#xFF0C;Nginx &#x9ED8;&#x8BA4;&#x7684;&#x7F16;&#x7801;&#x957F;&#x5EA6;&#x592A;&#x5F31;&#xFF0C;&#x4F7F;&#x7528; 2048 &#x4F4D;&#x7684;&#xFF1A;</p>
<pre><code><figure class="highlight hljs gradle"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code># openssl dhparam -out <span class="hljs-regexp">/etc/</span>ssl<span class="hljs-regexp">/certs/</span>dhparam.pem <span class="hljs-number">2048</span></code></pre></figure></code></pre><p>&#x7136;&#x540E;&#x521B;&#x5EFA;&#x8F6F;&#x8FDE;&#x63A5;&#x4F7F;&#x914D;&#x7F6E;&#x751F;&#x6548;&#xFF0C;&#x5E76;&#x91CD;&#x542F; Nginx&#xFF1A;</p>
<pre><code><figure class="highlight hljs gradle"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
</pre><pre class="code"><code># ln -s <span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/sites-available/</span>example.com <span class="hljs-regexp">/etc/</span>nginx<span class="hljs-regexp">/sites-enabled/</span>
# systemctl restart nginx</code></pre></figure></code></pre><p>&#x5982;&#x679C;&#x4F60;&#x8FD8;&#x6709;&#x5176;&#x4ED6;&#x7684;&#x9875;&#x9762;&#xFF0C;&#x653E;&#x5728;&#x53E6;&#x4E00;&#x4E2A;&#x76EE;&#x5F55;&#x91CC;&#xFF0C;&#x7136;&#x540E;&#x518D;&#x521B;&#x5EFA;&#x4E00;&#x4EFD;&#x914D;&#x7F6E;&#x6587;&#x4EF6;&#xFF0C;&#x5F53;&#x7136;&#x8FD9;&#x6B21;&#x53EA;&#x8981;&#x6709;&#x7B2C;&#x4E8C;&#x4E2A; server &#x5B57;&#x6BB5;&#x5C31;&#x597D;&#x4E86;&#xFF0C;&#x4FEE;&#x6539;&#x8DEF;&#x5F84;&#xFF0C;&#x7136;&#x540E;&#x8FDE;&#x63A5;&#x91CD;&#x542F;&#x3002;</p>
<h1 id="&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x8BC1;&#x4E66;"><a class="headerlink" href="/posts/Hexo-on-VPS-with-Nginx-and-HTTPS/#%E8%87%AA%E5%8A%A8%E6%9B%B4%E6%96%B0%E8%AF%81%E4%B9%A6" title="&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x8BC1;&#x4E66;"></a>&#x81EA;&#x52A8;&#x66F4;&#x65B0;&#x8BC1;&#x4E66;</h1>
<p>&#x5B89;&#x5168;&#x8D77;&#x89C1;&#xFF0C;Let&apos;s Encrypt &#x7B7E;&#x53D1;&#x7684;&#x8BC1;&#x4E66;&#x53EA;&#x6709; 90 &#x5929;&#x6709;&#x6548;&#x671F;&#xFF0C;&#x5B98;&#x65B9;&#x63A8;&#x8350;&#x4F7F;&#x7528;&#x81EA;&#x52A8;&#x5B9A;&#x671F;&#x5237;&#x65B0;&#x7684;&#x65B9;&#x5F0F;&#x66F4;&#x65B0;&#x8BC1;&#x4E66;&#xFF0C;&#x53EA;&#x9700;&#x8981;&#x5EFA;&#x7ACB;&#x4E00;&#x4E2A;&#x5B9A;&#x65F6;&#x4EFB;&#x52A1;&#x8FD0;&#x884C; <code>/PATH/TO/certbot-auto renew --pre-hook &quot;systemctl stop nginx&quot; --post-hook &quot;systemctl start nginx&quot;</code>&#xFF08;&#x5982;&#x679C;&#x4F60;&#x7528;&#x7684;&#x4E0D;&#x662F; systemd &#x7BA1;&#x7406; Nginx &#x8BB0;&#x5F97;&#x6362;&#x6210;&#x5176;&#x5B83;&#x7684;&#x505C;&#x6B62;&#x548C;&#x542F;&#x52A8; Nginx &#x7684;&#x547D;&#x4EE4;&#xFF09;&#x3002;&#x5F88;&#x5927;&#x53EF;&#x80FD;&#x4F60;&#x77E5;&#x9053;&#x600E;&#x4E48;&#x7528; crontab &#x505A;&#x8FD9;&#x4EF6;&#x4E8B;&#x60C5;&#xFF0C;&#x4F46;&#x6211;&#x4F7F;&#x7528; systemd-timer &#x505A;&#x3002;</p>
<p>&#x9996;&#x5148;&#x5EFA;&#x7ACB; <code>/lib/systemd/system/certbot-renew.service</code> &#x8FD9;&#x4E2A;&#x6587;&#x4EF6;&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="ini"><figure class="highlight hljs ini"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
</pre><pre class="code"><code><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=Updates cert file via certbot
<span class="hljs-section">
[Service]</span>
<span class="hljs-attr">Type</span>=<span class="hljs-literal">on</span>eshot
<span class="hljs-attr">ExecStart</span>=/home/alynx/certbot-auto renew --pre-hook <span class="hljs-string">&quot;systemctl stop nginx&quot;</span> --post-hook <span class="hljs-string">&quot;systemctl start nginx&quot;</span></code></pre></figure></code></pre>
<p>&#x7136;&#x540E;&#x5EFA;&#x7ACB;&#x5BF9;&#x5E94;&#x7684; timer <code>/lib/systemd/system/certbot-renew.timer</code>&#xFF0C;&#x5185;&#x5BB9;&#x5982;&#x4E0B;&#xFF1A;</p>
<pre><code class="ini"><figure class="highlight hljs ini"><pre class="gutter"><span class="line">1</span>
<span class="line">2</span>
<span class="line">3</span>
<span class="line">4</span>
<span class="line">5</span>
<span class="line">6</span>
<span class="line">7</span>
<span class="line">8</span>
<span class="line">9</span>
<span class="line">10</span>
</pre><pre class="code"><code><span class="hljs-section">[Unit]</span>
<span class="hljs-attr">Description</span>=Updates cert files via certbot every week
<span class="hljs-section">
[Timer]</span>
<span class="hljs-attr">OnBootSec</span>=<span class="hljs-number">1</span>min
<span class="hljs-attr">OnUnitActiveSec</span>=<span class="hljs-number">1</span>week
<span class="hljs-attr">Unit</span>=certbot-renew.service
<span class="hljs-section">
[Install]</span>
<span class="hljs-attr">WantedBy</span>=multi-user.target</code></pre></figure></code></pre>
<p>&#x8FD9;&#x4E2A; timer &#x4F1A;&#x5728;&#x542F;&#x52A8; 1 &#x5206;&#x949F;&#x4E4B;&#x540E;&#x8FD0;&#x884C; certbot-renew.service&#xFF0C;&#x540C;&#x65F6;&#x6BCF;&#x5468;&#x8FD0;&#x884C;&#x4E00;&#x6B21;&#x6765;&#x786E;&#x4FDD;&#x4F60;&#x7684;&#x8BC1;&#x4E66;&#x4F1A;&#x88AB;&#x5237;&#x65B0;&#x3002;</p>
<p>&#x542F;&#x52A8;&#x5B83;&#xFF1A;</p>
<pre><code><figure class="highlight hljs shell"><pre class="gutter"><span class="line">1</span>
</pre><pre class="code"><code><span class="hljs-meta">#</span><span class="bash"> systemctl <span class="hljs-built_in">enable</span> certbot-renew.timer --now</span></code></pre></figure></code></pre><p>&#x7136;&#x540E;&#x66F4;&#x65B0;&#x4F60;&#x7684; DNS &#x7684; A &#x8BB0;&#x5F55;&#x548C; AAAA &#x8BB0;&#x5F55;&#xFF0C;&#x751F;&#x6548;&#x5C31;&#x53EF;&#x4EE5;&#x4E86;&#x3002;</p>
<p>&#x6709;&#x5907;&#x65E0;&#x60A3;&#x54AF;&#xFF01;</p>
<p>&#x66F4;&#x65B0;&#xFF1A;&#x6211;&#x7684; VPS &#x88AB;&#x5899;&#x4E86;&#xFF0C;&#x7B97;&#x4E86;&#xFF0C;&#x5657;&#x3002;</p>
<p><em>AlynxZhou</em></p>
<p><strong>A Coder &amp; Dreamer</strong></p>

    </main>
    <footer class="post-footer">
      
      <div class="post-tags">
        <a class="post-tag button" href="/tags/Hexo/" rel="tag"><i class="fas fa-tag"></i>Hexo</a><a class="post-tag button" href="/tags/Nginx/" rel="tag"><i class="fas fa-tag"></i>Nginx</a>
      </div>
      
    </footer>
  </article>
  
  <nav class="page-nav">
    <div class="page-nav-next page-nav-item">
      
      <a href="/posts/Automata/" rel="next" title="Automata: A Story of Love and Lives"><i class="fas fa-angle-left"></i><span class="nav-title">Automata: A Story of Love and Lives</span></a>
      
    </div>
    <div class="page-nav-prev page-nav-item">
      
      <a href="/posts/Endless-ARIA/" rel="prev" title="无尽的咏叹回荡于伽蓝之世界中 —— 有关 ARIA"><span class="nav-title">无尽的咏叹回荡于伽蓝之世界中 —— 有关 ARIA</span><i class="fas fa-angle-right"></i></a>
      
    </div>
  </nav>
  
  
  

<div class="reward" id="reward">
  <p>既然看了喵写的文章，不打算投喂一下再走吗？哼！</p>
  <button id="reward-button" class="button" disable="enable"><i class="fas fa-donate"></i>打赏</button>
  <div id="qr" class="qr" style="display: none;" aria-hidden="true">
    
    <div id="wechatpay">
      <img id="wechatpay-qr" src="/images/WeChatPay.png" alt="微信支付"/>
      <span>微信支付</span>
    </div>
    
    
    <div id="alipay">
      <img id="alipay-qr" src="/images/AliPay.png" alt="支付宝"/>
      <span>支付宝</span>
    </div>
    
    
  </div>
</div>



  
  
  

<div class="comments" id="comments">
  
  <div class="commentjs" id="comment-thread"></div>
  <link rel="stylesheet" href="/css/commentjs.css">
  <script defer type="text/javascript" src="/js/marked.min.js"></script>
  <script defer type="text/javascript" src="/js/timeago.min.js"></script>
  <script defer type="text/javascript" src="/js/highlight.min.js"></script>
  <script defer type="text/javascript" src="/js/commentjs.js"></script>
  <script type="text/javascript">
  $(document).ready(function () {
    getComments({
      "type": "github",
      "user": "AlynxZhou",
      "repo": "stackharbor",
      "clientID": "",
      "clientSecret": "6db7dd16477eadc1e96160a23c6ba4cf687dcecf",
      "no_comment": "这个页面还没有评论，现在就去评论吧！",
      "go_to_comment": "去评论",
      "issue_title": "在 VPS 上用 Nginx 和 HTTPS 部署 Hexo 生成的页面",
      "btn_class": "button",
      "comments_target": "#comment-thread"
    });
    marked.setOptions({
      "highlight": function (code, lang) {
        return hljs.highlightAuto(code).value;
      }
    });
    function mark() {
      var markdowns = document.getElementsByClassName("markdown");
      for (var i = 0; i < markdowns.length; ++i){
        if (markdowns[i].innerHTML) {
          markdowns[i].innerHTML = marked(markdowns[i].innerHTML);
        }
      }
    }
    window.addEventListener("DOMContentLoaded", mark, false);
    window.addEventListener("load", mark, false);
  });
  </script>
  
</div>



  
</div>

          </div>
          
          
          
<aside class="sidebar" id="sidebar" style="background: url(/images/background.png);">
  
  <div class="search">
    <div class="form-group">
      <i class="fas fa-search"></i><input type="search" id="search-input" name="q" results="0" placeholder="搜索" class="form-control"/>
    </div>
  </div>
  <div class="search-result-box" id="search-result"></div>
  
  
<div class="info sidebar-item" id="info">
  
  <img class="author-avatar" src="/images/Future_Gazer_small.png" alt="Alynx Zhou">
  
  <h1 class="author-name">Alynx Zhou</h1>
  <h2 class="author-description">望むものなら残さず<br>輝ける自分らしさで</h2>
  <div class="site-count">
    
    
    
    
    <div class="archives-count count-block">
      <div class="site-count-title">归档</div>
      <div><a href="/archives/">57</a></div>
    </div>
    
    
    
    <div class="categories-count count-block">
      <div class="site-count-title">分类</div>
      <div><a href="/categories/">38</a></div>
    </div>
    
    
    
    <div class="tags-count count-block">
      <div class="site-count-title">标签</div>
      <div><a href="/tags/">60</a></div>
    </div>
    
    
    
    
    
    
    
    
  </div>
  
  <div class="rss">
    <a class="rss-link button sidebar-item" href="/atom.xml"><i class="fas fa-rss"></i>RSS</a>
  </div>
  
</div>


  <div class="sidebar-sticky">
    
    
    <hr>
    <div class="post-toc sidebar-item" id="toc-div">
      <div><i class="fas fa-list-ol"></i>文章目录</div>
      <div class="post-toc-content">
        
        
        <ol class="list-group toc">
        
          <li>
            <a class="list-group-item toc-link" href="#用Rsync上传Hexo生成的网页">用 Rsync 上传 Hexo 生成的网页</a>
            
          </li>
        
          <li>
            <a class="list-group-item toc-link" href="#用Let039;sEncrypt生成SSL证书">用 Let's Encrypt 生成 SSL 证书</a>
            
            
        <ol >
        
          <li>
            <a class="list-group-item toc-link" href="#下载certbot-auto">下载 certbot-auto</a>
            
          </li>
        
          <li>
            <a class="list-group-item toc-link" href="#手动生成证书">手动生成证书</a>
            
          </li>
        
        </ol>
        
            
          </li>
        
          <li>
            <a class="list-group-item toc-link" href="#设置Nginx">设置 Nginx</a>
            
            
        <ol >
        
          <li>
            <a class="list-group-item toc-link" href="#强制HTTPS">强制 HTTPS</a>
            
          </li>
        
          <li>
            <a class="list-group-item toc-link" href="#配置虚拟主机">配置虚拟主机</a>
            
          </li>
        
        </ol>
        
            
          </li>
        
          <li>
            <a class="list-group-item toc-link" href="#自动更新证书">自动更新证书</a>
            
          </li>
        
        </ol>
        
      </div>
    </div>
    
    
    
    <hr>
    <div class="social-link sidebar-item">
      <div><i class="far fa-address-card"></i>社交链接</p></div>
      <ul>
        
        <li><i class="fas fa-envelope"></i><a href="mailto:alynx.zhou@gmail.com" target="_blank">E-Mail</a></li>
        
        <li><i class="fab fa-github"></i><a href="https://github.com/AlynxZhou/" target="_blank">GitHub</a></li>
        
        <li><i class="fab fa-telegram-plane"></i><a href="https://t.me/AlynxZhou/" target="_blank">Telegram</a></li>
        
        <li><i class="fas fa-video"></i><a href="https://space.bilibili.com/10034969/" target="_blank">Bilibili</a></li>
        
        <li><i class="fab fa-weibo"></i><a href="https://weibo.com/u/5287501461" target="_blank">Weibo</a></li>
        
      </ul>
    </div>
    
    
    <hr>
    <div class="blogroll sidebar-item">
      <div><i class="fas fa-user-friends"></i>友情链接</div>
      <ul>
        
        <li><i class="fas fa-link"></i><a href="https://lrscy.github.io/" target="_blank">Meow's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://lgiki.cc/" target="_blank">LGiki's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://hackghost.com/" target="_blank">HackGhost's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://chenxy.moe/" target="_blank">Art_Chen's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://jm33.me/" target="_blank">Jm33_m0's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://farseerfc.me/" target="_blank">Farseerfc 的小窝</a></li>
        
        <li><i class="fas fa-link"></i><a href="http://huaji.store/" target="_blank">滑稽仓库</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://jitui.moe/" target="_blank">鸡腿工坊</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://sh.yorushika.co/" target="_blank">Yorushika Shi's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://sqyon.com/" target="_blank">Sqyon's Blog</a></li>
        
        <li><i class="fas fa-link"></i><a href="https://blog.yoitsu.moe/" target="_blank">约伊兹的萌狼乡手札</a></li>
        
      </ul>
    </div>
    
  </div>
</aside>


          
        </div>
      </div>
    </main>
    
<footer id="footer" class="footer" style="background: #33363b;">
  <div class="container">
    <div class="back-to-top">
      <button id="back-to-top"><i class="fas fa-angle-double-up" aria-label="回到顶部"></i></button>
    </div>
    <div class="footer-container">
      <div class="footer-left">
        <div class="copyright">
          <span class="author"><i class="far fa-edit"></i>Alynx Zhou</span><span class="years"><i class="far fa-copyright"></i><span id="years-text">2016</span></span><span class="creative-commons"><i class="fab fa-creative-commons"></i><a href="http://creativecommons.org/licenses/by-nc-nd/4.0/" target="_blank">BY-NC-ND 4.0</a></span>
        </div>
        
        <div class="busuanzi">
          <span id="busuanzi_container_site_pv"><i class="fas fa-eye" aria-label="站点点击量" aria-hidden="false"></i><span id="busuanzi_value_site_pv"></span></span><span id="busuanzi_container_site_uv"><i class="fas fa-user" aria-label="站点用户数" aria-hidden="false"></i><span id="busuanzi_value_site_uv"></span></span><span id="busuanzi_container_page_pv"><i class="fas fa-file-alt"></i><span id="busuanzi_value_page_pv" aria-label="页面点击量" aria-hidden="false"></span></span>
        </div>
        
      </div>
      <div class="footer-right">
        <div class="custom-info">
          
          托管于<i class="fab fa-github-alt"></i><a href="https://pages.github.com/" target="_blank">GitHub Pages</a>
          
        </div>
        <div class="powered-by">
          由 <a href="https://github.com/AlynxZhou/hikaru/" target="_blank">Hikaru</a> 强力驱动<i class="fab fa-node-js"></i>主题 <a href="https://github.com/AlynxZhou/hikaru-theme-aria/" target="_blank">ARIA</a>
        </div>
      </div>
    </div>
  </div>
</footer>


  </body>
</html>
<!-- Page built by Hikaru v1.14.2 at 2019-05-10 周五 22:13:18 CST. -->
